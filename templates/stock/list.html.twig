{% extends 'back.base.html.twig' %}




{% block body %}
<div class="row">
<div class="col-lg-12 grid-margin stretch-card">
              <div class="card">
                <div class="card-body">
                  <h4 class="card-title">Stock</h4>
                  <p class="card-description">
                    list of stocks
                  </p>
                  <!-- Dropdown to choose sorting order -->
        <div class="mb-3">
          <label for="sortOrder" class="form-label">Sort by Quantites</label>
          <select id="sortOrder" class="form-select">
            <option value="asc">Ascending</option>
            <option value="desc">Descending</option>
          </select>
        </div>

                  <div class="table-responsive pt-3" id="stockTable">
                    <table class="table table-bordered">
                      <thead>
                        <tr>
                                            <th>Stockid</th>
                <th>Prixunitaires</th>
                <th>Codeproduits</th>
                <th>Quantites</th>
                <th>Daterestocks</th>
                <th>actions</th>
                                        </tr>
                      </thead>
                     <tbody id="myTable">
                                     {% for stock in stocks %}
                                       <tr>
                <td>{{ stock.stockid }}</td>
                <td>{{ stock.prixunitaires }}</td>
                <td>{{ stock.codeproduits }}</td>
                <td>{{ stock.quantites }}</td>
                <td>{{ stock.daterestocks ? stock.daterestocks|date('Y-m-d') : '' }}</td>
                <td>
                    <a href="{{ path('app_stock_show', {'stockid': stock.stockid}) }}">show</a>
                    <a href="{{ path('app_stock_edit', {'stockid': stock.stockid}) }}">edit</a>
                </td>
            </tr>
                                {% else %}
            <tr>
                <td colspan="6">no records found</td>
            </tr>
        {% endfor %}        
                      </tbody>
                    </table>
                     <div class="container py-5">
  <div class="d-flex justify-content-center">
{{ knp_pagination_render(stocks) }}

</div>
</div>
<a class="btn btn-primary" href="{{ path('app_stock_new') }}">Create new</a>
<a class="btn btn-primary" href="{{ path('app_stock_pdf') }}">Export to pdf</a>
                  </div>
                </div>
              </div>
            </div>
            </div>

            <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>

            
<script>
  $('#sortOrder').change(function() { 
    const sortOrder = $(this).val(); // Get selected sorting order
    const rows = $('#stockTable tbody tr').get(); // Get all rows

    // Sort based on the selected order
    rows.sort(function(a, b) {
      const aQty = parseFloat($(a).children('td').eq(3).text()); // Quantites
      const bQty = parseFloat($(b).children('td').eq(3).text());
      
      if (sortOrder === 'asc') {
        return aQty - bQty;
      } else {
        return bQty - aQty;
      }
    });

    // Re-insert sorted rows
    $.each(rows, function(index, row) {
      $('#stockTable tbody').append(row);
    });
  });
</script>
{% endblock %}